// Code generated by transpiler. DO NOT EDIT.

/**
 * Go Video Downloader
 *
 *    Copyright 2019 Tenta, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * For any questions, please contact developer@tenta.io
 *
 * nexx/module.go: transpiled from https://github.com/ytdl-org/youtube-dl/blob/master/youtube_dl/extractor/nexx.py
 */

package nexx

import (
	惟re "github.com/tenta-browser/go-video-downloader/gen/re"
	惟time "github.com/tenta-browser/go-video-downloader/gen/time"
	惟compat "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/compat"
	惟common "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/extractor/common"
	惟utils "github.com/tenta-browser/go-video-downloader/gen/youtube_dl/utils"
	位 "github.com/tenta-browser/go-video-downloader/runtime"
)

var (
	ExtractorError      位.Object
	InfoExtractor       位.Object
	NexxEmbedIE         位.Object
	NexxIE              位.Object
	compat_str         位.Object
	int_or_none        位.Object
	parse_duration     位.Object
	try_get            位.Object
	urlencode_postdata 位.Object
)

func init() {
	位.InitModule(func() {
		InfoExtractor = 惟common.InfoExtractor
		compat_str = 惟compat.compat_str
		ExtractorError = 惟utils.ExtractorError
		int_or_none = 惟utils.int_or_none
		parse_duration = 惟utils.parse_duration
		try_get = 惟utils.try_get
		urlencode_postdata = 惟utils.urlencode_postdata
		NexxIE = 位.Cal(位.TypeType, 位.NewStr("NexxIE"), 位.NewTuple(InfoExtractor), func() 位.Dict {
			var (
				NexxIE__TESTS                 位.Object
				NexxIE__VALID_URL             位.Object
				NexxIE__extract_azure_formats 位.Object
				NexxIE__extract_free_formats  位.Object
				NexxIE__real_extract          位.Object
			)
			NexxIE__VALID_URL = 位.NewStr("(?x)\n                        (?:\n                            https?://api\\.nexx(?:\\.cloud|cdn\\.com)/v3/(?P<domain_id>\\d+)/videos/byid/|\n                            nexx:(?:(?P<domain_id_s>\\d+):)?|\n                            https?://arc\\.nexx\\.cloud/api/video/\n                        )\n                        (?P<id>\\d+)\n                    ")
			NexxIE__TESTS = 位.NewList(
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"): 位.NewStr("https://api.nexx.cloud/v3/748/videos/byid/128907"),
					位.NewStr("md5"): 位.NewStr("31899fd683de49ad46f4ee67e53e83fe"),
					位.NewStr("info_dict"): 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("id"):          位.NewStr("128907"),
						位.NewStr("ext"):         位.NewStr("mp4"),
						位.NewStr("title"):       位.NewStr("Stiftung Warentest"),
						位.NewStr("alt_title"):   位.NewStr("Wie ein Test abl盲uft"),
						位.NewStr("description"): 位.NewStr("md5:d1ddb1ef63de721132abd38639cc2fd2"),
						位.NewStr("creator"):     位.NewStr("SPIEGEL TV"),
						位.NewStr("thumbnail"):   位.NewStr("re:^https?://.*\\.jpg$"),
						位.NewStr("duration"):    位.NewInt(2509),
						位.NewStr("timestamp"):   位.NewInt(1384264416),
						位.NewStr("upload_date"): 位.NewStr("20131112"),
					}),
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"): 位.NewStr("https://api.nexx.cloud/v3/741/videos/byid/247858"),
					位.NewStr("info_dict"): 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("id"):             位.NewStr("247858"),
						位.NewStr("ext"):            位.NewStr("mp4"),
						位.NewStr("title"):          位.NewStr("Return of the Golden Child (OV)"),
						位.NewStr("description"):    位.NewStr("md5:5d969537509a92b733de21bae249dc63"),
						位.NewStr("release_year"):   位.NewInt(2017),
						位.NewStr("thumbnail"):      位.NewStr("re:^https?://.*\\.jpg$"),
						位.NewStr("duration"):       位.NewInt(1397),
						位.NewStr("timestamp"):      位.NewInt(1495033267),
						位.NewStr("upload_date"):    位.NewStr("20170517"),
						位.NewStr("episode_number"): 位.NewInt(2),
						位.NewStr("season_number"):  位.NewInt(2),
					}),
					位.NewStr("params"): 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("skip_download"): 位.True,
					}),
					位.NewStr("skip"): 位.NewStr("HTTP Error 404: Not Found"),
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"): 位.NewStr("nexx:741:1269984"),
					位.NewStr("md5"): 位.NewStr("c714b5b238b2958dc8d5642addba6886"),
					位.NewStr("info_dict"): 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("id"):          位.NewStr("1269984"),
						位.NewStr("ext"):         位.NewStr("mp4"),
						位.NewStr("title"):       位.NewStr("1 TAG ohne KLO... wortw枚rtlich! "),
						位.NewStr("alt_title"):   位.NewStr("1 TAG ohne KLO... wortw枚rtlich! "),
						位.NewStr("thumbnail"):   位.NewStr("re:^https?://.*\\.jpg$"),
						位.NewStr("duration"):    位.NewInt(607),
						位.NewStr("timestamp"):   位.NewInt(1518614955),
						位.NewStr("upload_date"): 位.NewStr("20180214"),
					}),
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"): 位.NewStr("nexx:747:1533779"),
					位.NewStr("md5"): 位.NewStr("6bf6883912b82b7069fb86c2297e9893"),
					位.NewStr("info_dict"): 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("id"):          位.NewStr("1533779"),
						位.NewStr("ext"):         位.NewStr("mp4"),
						位.NewStr("title"):       位.NewStr("Aufregung um ausgebrochene Raubtiere"),
						位.NewStr("alt_title"):   位.NewStr("Eifel-Zoo"),
						位.NewStr("description"): 位.NewStr("md5:f21375c91c74ad741dcb164c427999d2"),
						位.NewStr("thumbnail"):   位.NewStr("re:^https?://.*\\.jpg$"),
						位.NewStr("duration"):    位.NewInt(111),
						位.NewStr("timestamp"):   位.NewInt(1527874460),
						位.NewStr("upload_date"): 位.NewStr("20180601"),
					}),
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"):           位.NewStr("https://api.nexxcdn.com/v3/748/videos/byid/128907"),
					位.NewStr("only_matching"): 位.True,
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"):           位.NewStr("nexx:748:128907"),
					位.NewStr("only_matching"): 位.True,
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"):           位.NewStr("nexx:128907"),
					位.NewStr("only_matching"): 位.True,
				}),
				位.NewDictWithTable(map[位.Object]位.Object{
					位.NewStr("url"):           位.NewStr("https://arc.nexx.cloud/api/video/128907.json"),
					位.NewStr("only_matching"): 位.True,
				}),
			)
			NexxIE__extract_free_formats = 位.NewFunction("_extract_free_formats",
				[]位.Param{
					{Name: "self"},
					{Name: "video"},
					{Name: "video_id"},
				},
				0, false, false,
				func(位args []位.Object) 位.Object {
					var (
						a            位.Object
						cdn          位.Object
						cdn_provider 位.Object
						f            位.Object
						fd           位.Object
						filename     位.Object
						formats      位.Object
						h            位.Object
						hash         位.Object
						http_base    位.Object
						i            位.Object
						k            位.Object
						p            位.Object
						p0           位.Object
						ps           位.Object
						s            位.Object
						self         = 位args[0]
						stream_data  位.Object
						t            位.Object
						tbr          位.Object
						video        = 位args[1]
						video_id     = 位args[2]
						width_height 位.Object
						mp0          位.Object
						mp1          位.Object
						mp2          位.Object
					)
					stream_data = 位.GetItem(video, 位.NewStr("streamdata"))
					cdn = 位.GetItem(stream_data, 位.NewStr("cdnType"))
					if !位.IsTrue(位.Eq(cdn, 位.NewStr("free"))) {
						panic(位.Raise(位.Cal(位.AssertionErrorType)))
					}
					hash = 位.GetItem(位.GetItem(video, 位.NewStr("general")), 位.NewStr("hash"))
					ps = 位.Cal(compat_str, 位.GetItem(stream_data, 位.NewStr("originalDomain")))
					if 位.IsTrue(位.Eq(位.GetItem(stream_data, 位.NewStr("applyFolderHierarchy")), 位.NewInt(1))) {
						s = 位.GetItem(位.Mod(位.NewStr("%04d"), 位.Cal(位.IntType, video_id)), 位.NewSlice(位.None, 位.None, 位.Neg(位.NewInt(1))))
						mp0 = 位.IAdd(ps, 位.Mod(位.NewStr("/%s/%s"), 位.NewTuple(
							位.GetItem(s, 位.NewSlice(位.NewInt(0), 位.NewInt(2), 位.None)),
							位.GetItem(s, 位.NewSlice(位.NewInt(2), 位.NewInt(4), 位.None)),
						)))
						ps = mp0
					}
					mp0 = 位.IAdd(ps, 位.Mod(位.NewStr("/%s/%s_"), 位.NewTuple(
						video_id,
						hash,
					)))
					ps = mp0
					t = 位.Add(位.NewStr("http://%s"), ps)
					fd = 位.Cal(位.GetAttr(位.GetItem(stream_data, 位.NewStr("azureFileDistribution")), "split", nil), 位.NewStr(","))
					cdn_provider = 位.GetItem(stream_data, 位.NewStr("cdnProvider"))
					p0 = 位.NewFunction("p0",
						[]位.Param{
							{Name: "p"},
						},
						0, false, false,
						func(位args []位.Object) 位.Object {
							var (
								p = 位args[0]
							)
							return func() 位.Object {
								if 位.IsTrue(位.Eq(位.GetItem(stream_data, 位.NewStr("applyAzureStructure")), 位.NewInt(1))) {
									return 位.Mod(位.NewStr("_%s"), p)
								} else {
									return 位.NewStr("")
								}
							}()
						})
					formats = 位.NewList()
					if 位.IsTrue(位.Eq(cdn_provider, 位.NewStr("ak"))) {
						mp0 = 位.IAdd(t, 位.NewStr(","))
						t = mp0
						mp0 = 位.Cal(位.BuiltinIter, fd)
						for {
							if mp1 = 位.NextDefault(mp0, 位.AfterLast); mp1 == 位.AfterLast {
								break
							}
							i = mp1
							p = 位.Cal(位.GetAttr(i, "split", nil), 位.NewStr(":"))
							mp2 = 位.IAdd(t, 位.Add(位.Add(位.GetItem(p, 位.NewInt(1)), 位.Cal(p0, 位.Cal(位.IntType, 位.GetItem(p, 位.NewInt(0))))), 位.NewStr(",")))
							t = mp2
						}
						mp0 = 位.IAdd(t, 位.NewStr(".mp4.csmil/master.%s"))
						t = mp0
					} else {
						if 位.IsTrue(位.Eq(cdn_provider, 位.NewStr("ce"))) {
							k = 位.Cal(位.GetAttr(t, "split", nil), 位.NewStr("/"))
							h = 位.Cal(位.GetAttr(k, "pop", nil))
							mp0 = 位.Cal(位.GetAttr(位.NewStr("/"), "join", nil), k)
							http_base = mp0
							t = mp0
							http_base = 位.Mod(http_base, 位.GetItem(stream_data, 位.NewStr("cdnPathHTTP")))
							mp0 = 位.IAdd(t, 位.NewStr("/asset.ism/manifest.%s?dcp_ver=aos4&videostream="))
							t = mp0
							mp0 = 位.Cal(位.BuiltinIter, fd)
							for {
								if mp1 = 位.NextDefault(mp0, 位.AfterLast); mp1 == 位.AfterLast {
									break
								}
								i = mp1
								p = 位.Cal(位.GetAttr(i, "split", nil), 位.NewStr(":"))
								tbr = 位.Cal(位.IntType, 位.GetItem(p, 位.NewInt(0)))
								filename = 位.Mod(位.NewStr("%s%s%s.mp4"), 位.NewTuple(
									h,
									位.GetItem(p, 位.NewInt(1)),
									位.Cal(p0, tbr),
								))
								f = 位.NewDictWithTable(map[位.Object]位.Object{
									位.NewStr("url"): 位.Add(位.Add(http_base, 位.NewStr("/")), filename),
									位.NewStr("format_id"): 位.Mod(位.NewStr("%s-http-%d"), 位.NewTuple(
										cdn,
										tbr,
									)),
									位.NewStr("tbr"): tbr,
								})
								width_height = 位.Cal(位.GetAttr(位.GetItem(p, 位.NewInt(1)), "split", nil), 位.NewStr("x"))
								if 位.IsTrue(位.Eq(位.Cal(位.BuiltinLen, width_height), 位.NewInt(2))) {
									位.Cal(位.GetAttr(f, "update", nil), 位.NewDictWithTable(map[位.Object]位.Object{
										位.NewStr("width"):  位.Cal(int_or_none, 位.GetItem(width_height, 位.NewInt(0))),
										位.NewStr("height"): 位.Cal(int_or_none, 位.GetItem(width_height, 位.NewInt(1))),
									}))
								}
								位.Cal(位.GetAttr(formats, "append", nil), f)
								a = 位.Add(filename, 位.Mod(位.NewStr(":%s"), 位.Mul(tbr, 位.NewInt(1000))))
								mp2 = 位.IAdd(t, 位.Add(a, 位.NewStr(",")))
								t = mp2
							}
							t = 位.Add(位.Add(位.GetItem(t, 位.NewSlice(位.None, 位.Neg(位.NewInt(1)), 位.None)), 位.NewStr("&audiostream=")), 位.GetItem(位.Cal(位.GetAttr(a, "split", nil), 位.NewStr(":")), 位.NewInt(0)))
						} else {
							if !位.IsTrue(位.False) {
								panic(位.Raise(位.Cal(位.AssertionErrorType)))
							}
						}
					}
					if 位.IsTrue(位.Eq(cdn_provider, 位.NewStr("ce"))) {
						位.Cal(位.GetAttr(formats, "extend", nil), 位.Call(位.GetAttr(self, "_extract_mpd_formats", nil), 位.NewArgs(
							位.Mod(t, 位.NewTuple(
								位.GetItem(stream_data, 位.NewStr("cdnPathDASH")),
								位.NewStr("mpd"),
							)),
							video_id,
						), 位.KWArgs{
							{Name: "mpd_id", Value: 位.Mod(位.NewStr("%s-dash"), cdn)},
							{Name: "fatal", Value: 位.False},
						}))
					}
					位.Cal(位.GetAttr(formats, "extend", nil), 位.Call(位.GetAttr(self, "_extract_m3u8_formats", nil), 位.NewArgs(
						位.Mod(t, 位.NewTuple(
							位.GetItem(stream_data, 位.NewStr("cdnPathHLS")),
							位.NewStr("m3u8"),
						)),
						video_id,
						位.NewStr("mp4"),
					), 位.KWArgs{
						{Name: "entry_protocol", Value: 位.NewStr("m3u8_native")},
						{Name: "m3u8_id", Value: 位.Mod(位.NewStr("%s-hls"), cdn)},
						{Name: "fatal", Value: 位.False},
					}))
					return formats
				})
			NexxIE__extract_azure_formats = 位.NewFunction("_extract_azure_formats",
				[]位.Param{
					{Name: "self"},
					{Name: "video"},
					{Name: "video_id"},
				},
				0, false, false,
				func(位args []位.Object) 位.Object {
					var (
						azure_file_distribution 位.Object
						azure_locator           位.Object
						azure_manifest_url      位.Object
						azure_progressive_base  位.Object
						azure_stream_base       位.Object
						cdn                     位.Object
						f                       位.Object
						fd                      位.Object
						fds                     位.Object
						formats                 位.Object
						get_cdn_shield_base     位.Object
						is_ml                   位.Object
						language                位.Object
						protection_token        位.Object
						self                    = 位args[0]
						ss                      位.Object
						stream_data             位.Object
						tbr                     位.Object
						video                   = 位args[1]
						video_id                = 位args[2]
						width_height            位.Object
						mp0                     位.Object
						mp1                     位.Object
					)
					stream_data = 位.GetItem(video, 位.NewStr("streamdata"))
					cdn = 位.GetItem(stream_data, 位.NewStr("cdnType"))
					if !位.IsTrue(位.Eq(cdn, 位.NewStr("azure"))) {
						panic(位.Raise(位.Cal(位.AssertionErrorType)))
					}
					azure_locator = 位.GetItem(stream_data, 位.NewStr("azureLocator"))
					get_cdn_shield_base = 位.NewFunction("get_cdn_shield_base",
						[]位.Param{
							{Name: "shield_type", Def: 位.NewStr("")},
							{Name: "static", Def: 位.False},
						},
						0, false, false,
						func(位args []位.Object) 位.Object {
							var (
								account     位.Object
								cdn_shield  位.Object
								prefix      位.Object
								secure      位.Object
								shield_type = 位args[0]
								static      = 位args[1]
								mp0         位.Object
								mp1         位.Object
							)
							mp0 = 位.Cal(位.BuiltinIter, 位.NewTuple(
								位.NewStr(""),
								位.NewStr("s"),
							))
							for {
								if mp1 = 位.NextDefault(mp0, 位.AfterLast); mp1 == 位.AfterLast {
									break
								}
								secure = mp1
								cdn_shield = 位.Cal(位.GetAttr(stream_data, "get", nil), 位.Mod(位.NewStr("cdnShield%sHTTP%s"), 位.NewTuple(
									shield_type,
									位.Cal(位.GetAttr(secure, "upper", nil)),
								)))
								if 位.IsTrue(cdn_shield) {
									return 位.Mod(位.NewStr("http%s://%s"), 位.NewTuple(
										secure,
										cdn_shield,
									))
								}
							}
							if mp1 == 位.AfterLast {
								if 位.IsTrue(位.NewBool(位.Contains(位.GetItem(stream_data, 位.NewStr("azureAccount")), 位.NewStr("fb")))) {
									prefix = func() 位.Object {
										if 位.IsTrue(static) {
											return 位.NewStr("df")
										} else {
											return 位.NewStr("f")
										}
									}()
								} else {
									prefix = func() 位.Object {
										if 位.IsTrue(static) {
											return 位.NewStr("d")
										} else {
											return 位.NewStr("p")
										}
									}()
								}
								account = 位.Cal(位.IntType, 位.Cal(位.GetAttr(位.Cal(位.GetAttr(位.GetItem(stream_data, 位.NewStr("azureAccount")), "replace", nil), 位.NewStr("nexxplayplus"), 位.NewStr("")), "replace", nil), 位.NewStr("nexxplayfb"), 位.NewStr("")))
								return 位.Mod(位.NewStr("http://nx-%s%02d.akamaized.net/"), 位.NewTuple(
									prefix,
									account,
								))
							}
							return 位.None
						})
					language = func() 位.Object {
						if 位v := 位.Cal(位.GetAttr(位.GetItem(video, 位.NewStr("general")), "get", nil), 位.NewStr("language_raw")); 位.IsTrue(位v) {
							return 位v
						} else {
							return 位.NewStr("")
						}
					}()
					azure_stream_base = 位.Cal(get_cdn_shield_base)
					is_ml = 位.NewBool(位.Contains(language, 位.NewStr(",")))
					azure_manifest_url = 位.Add(位.Mod(位.NewStr("%s%s/%s_src%s.ism/Manifest"), 位.NewTuple(
						azure_stream_base,
						azure_locator,
						video_id,
						func() 位.Object {
							if 位.IsTrue(is_ml) {
								return 位.NewStr("_manifest")
							} else {
								return 位.NewStr("")
							}
						}(),
					)), 位.NewStr("%s"))
					protection_token = 位.Cal(try_get, video, 位.NewFunction("<lambda>",
						[]位.Param{
							{Name: "x"},
						},
						0, false, false,
						func(位args []位.Object) 位.Object {
							var (
								x = 位args[0]
							)
							return 位.GetItem(位.GetItem(x, 位.NewStr("protectiondata")), 位.NewStr("token"))
						}), compat_str)
					if 位.IsTrue(protection_token) {
						mp0 = 位.IAdd(azure_manifest_url, 位.Mod(位.NewStr("?hdnts=%s"), protection_token))
						azure_manifest_url = mp0
					}
					formats = 位.Call(位.GetAttr(self, "_extract_m3u8_formats", nil), 位.NewArgs(
						位.Mod(azure_manifest_url, 位.NewStr("(format=m3u8-aapl)")),
						video_id,
						位.NewStr("mp4"),
						位.NewStr("m3u8_native"),
					), 位.KWArgs{
						{Name: "m3u8_id", Value: 位.Mod(位.NewStr("%s-hls"), cdn)},
						{Name: "fatal", Value: 位.False},
					})
					位.Cal(位.GetAttr(formats, "extend", nil), 位.Call(位.GetAttr(self, "_extract_mpd_formats", nil), 位.NewArgs(
						位.Mod(azure_manifest_url, 位.NewStr("(format=mpd-time-csf)")),
						video_id,
					), 位.KWArgs{
						{Name: "mpd_id", Value: 位.Mod(位.NewStr("%s-dash"), cdn)},
						{Name: "fatal", Value: 位.False},
					}))
					位.Cal(位.GetAttr(formats, "extend", nil), 位.Call(位.GetAttr(self, "_extract_ism_formats", nil), 位.NewArgs(
						位.Mod(azure_manifest_url, 位.NewStr("")),
						video_id,
					), 位.KWArgs{
						{Name: "ism_id", Value: 位.Mod(位.NewStr("%s-mss"), cdn)},
						{Name: "fatal", Value: 位.False},
					}))
					azure_progressive_base = 位.Cal(get_cdn_shield_base, 位.NewStr("Prog"), 位.True)
					azure_file_distribution = 位.Cal(位.GetAttr(stream_data, "get", nil), 位.NewStr("azureFileDistribution"))
					if 位.IsTrue(azure_file_distribution) {
						fds = 位.Cal(位.GetAttr(azure_file_distribution, "split", nil), 位.NewStr(","))
						if 位.IsTrue(fds) {
							mp0 = 位.Cal(位.BuiltinIter, fds)
							for {
								if mp1 = 位.NextDefault(mp0, 位.AfterLast); mp1 == 位.AfterLast {
									break
								}
								fd = mp1
								ss = 位.Cal(位.GetAttr(fd, "split", nil), 位.NewStr(":"))
								if 位.IsTrue(位.Eq(位.Cal(位.BuiltinLen, ss), 位.NewInt(2))) {
									tbr = 位.Cal(int_or_none, 位.GetItem(ss, 位.NewInt(0)))
									if 位.IsTrue(tbr) {
										f = 位.NewDictWithTable(map[位.Object]位.Object{
											位.NewStr("url"): 位.Mod(位.NewStr("%s%s/%s_src_%s_%d.mp4"), 位.NewTuple(
												azure_progressive_base,
												azure_locator,
												video_id,
												位.GetItem(ss, 位.NewInt(1)),
												tbr,
											)),
											位.NewStr("format_id"): 位.Mod(位.NewStr("%s-http-%d"), 位.NewTuple(
												cdn,
												tbr,
											)),
											位.NewStr("tbr"): tbr,
										})
										width_height = 位.Cal(位.GetAttr(位.GetItem(ss, 位.NewInt(1)), "split", nil), 位.NewStr("x"))
										if 位.IsTrue(位.Eq(位.Cal(位.BuiltinLen, width_height), 位.NewInt(2))) {
											位.Cal(位.GetAttr(f, "update", nil), 位.NewDictWithTable(map[位.Object]位.Object{
												位.NewStr("width"):  位.Cal(int_or_none, 位.GetItem(width_height, 位.NewInt(0))),
												位.NewStr("height"): 位.Cal(int_or_none, 位.GetItem(width_height, 位.NewInt(1))),
											}))
										}
										位.Cal(位.GetAttr(formats, "append", nil), f)
									}
								}
							}
						}
					}
					return formats
				})
			NexxIE__real_extract = 位.NewFunction("_real_extract",
				[]位.Param{
					{Name: "self"},
					{Name: "url"},
				},
				0, false, false,
				func(位args []位.Object) 位.Object {
					var (
						cdn           位.Object
						cid           位.Object
						device_id     位.Object
						domain_id     位.Object
						formats       位.Object
						general       位.Object
						mobj          位.Object
						op            位.Object
						request_token 位.Object
						response      位.Object
						result        位.Object
						secret        位.Object
						self          = 位args[0]
						title         位.Object
						url           = 位args[1]
						video         位.Object
						video_id      位.Object
					)
					mobj = 位.Cal(惟re.match, 位.GetAttr(self, "_VALID_URL", nil), url)
					domain_id = func() 位.Object {
						if 位v := 位.Cal(位.GetAttr(mobj, "group", nil), 位.NewStr("domain_id")); 位.IsTrue(位v) {
							return 位v
						} else {
							return 位.Cal(位.GetAttr(mobj, "group", nil), 位.NewStr("domain_id_s"))
						}
					}()
					video_id = 位.Cal(位.GetAttr(mobj, "group", nil), 位.NewStr("id"))
					video = 位.None
					response = 位.Call(位.GetAttr(self, "_download_json", nil), 位.NewArgs(
						位.Mod(位.NewStr("https://arc.nexx.cloud/api/video/%s.json"), video_id),
						video_id,
					), 位.KWArgs{
						{Name: "fatal", Value: 位.False},
					})
					if 位.IsTrue(func() 位.Object {
						if 位v := response; !位.IsTrue(位v) {
							return 位v
						} else {
							return 位.Cal(位.BuiltinIsInstance, response, 位.DictType)
						}
					}()) {
						result = 位.Cal(位.GetAttr(response, "get", nil), 位.NewStr("result"))
						if 位.IsTrue(func() 位.Object {
							if 位v := result; !位.IsTrue(位v) {
								return 位v
							} else {
								return 位.Cal(位.BuiltinIsInstance, result, 位.DictType)
							}
						}()) {
							video = result
						}
					}
					if 位.IsTrue(位.NewBool(!位.IsTrue(video))) {
						device_id = 位.Mod(位.NewStr("%d:%d:%d%d"), 位.NewTuple(
							位.Cal(位.None, 位.NewInt(1), 位.NewInt(4)),
							位.Cal(位.IntType, 位.Cal(惟time.time)),
							位.Cal(位.None, 位.NewFloat(10000.0), 位.NewInt(99999)),
							位.Cal(位.None, 位.NewInt(1), 位.NewInt(9)),
						))
						result = 位.Call(位.GetAttr(self, "_call_api", nil), 位.NewArgs(
							domain_id,
							位.NewStr("session/init"),
							video_id,
						), 位.KWArgs{
							{Name: "data", Value: 位.NewDictWithTable(map[位.Object]位.Object{
								位.NewStr("nxp_devh"):         device_id,
								位.NewStr("nxp_userh"):        位.NewStr(""),
								位.NewStr("precid"):           位.NewStr("0"),
								位.NewStr("playlicense"):      位.NewStr("0"),
								位.NewStr("screenx"):          位.NewStr("1920"),
								位.NewStr("screeny"):          位.NewStr("1080"),
								位.NewStr("playerversion"):    位.NewStr("6.0.00"),
								位.NewStr("gateway"):          位.NewStr("html5"),
								位.NewStr("adGateway"):        位.NewStr(""),
								位.NewStr("explicitlanguage"): 位.NewStr("en-US"),
								位.NewStr("addTextTemplates"): 位.NewStr("1"),
								位.NewStr("addDomainData"):    位.NewStr("1"),
								位.NewStr("addAdModel"):       位.NewStr("1"),
							})},
							{Name: "headers", Value: 位.NewDictWithTable(map[位.Object]位.Object{
								位.NewStr("X-Request-Enable-Auth-Fallback"): 位.NewStr("1"),
							})},
						})
						cid = 位.GetItem(位.GetItem(result, 位.NewStr("general")), 位.NewStr("cid"))
						secret = 位.GetItem(位.GetItem(位.GetItem(result, 位.NewStr("device")), 位.NewStr("clienttoken")), 位.NewSlice(位.Cal(位.IntType, 位.GetItem(device_id, 位.NewInt(0))), 位.None, 位.None))
						secret = 位.GetItem(secret, 位.NewSlice(位.NewInt(0), 位.Sub(位.Cal(位.BuiltinLen, secret), 位.Cal(位.IntType, 位.GetItem(device_id, 位.Neg(位.NewInt(1))))), 位.None))
						op = 位.NewStr("byid")
						request_token = 位.Cal(位.GetAttr(位.Cal(位.GetAttr(位.None, "md5", nil), 位.Cal(位.GetAttr(位.Cal(位.GetAttr(位.NewStr(""), "join", nil), 位.NewTuple(
							op,
							domain_id,
							secret,
						)), "encode", nil), 位.NewStr("utf-8"))), "hexdigest", nil))
						video = 位.Call(位.GetAttr(self, "_call_api", nil), 位.NewArgs(
							domain_id,
							位.Mod(位.NewStr("videos/%s/%s"), 位.NewTuple(
								op,
								video_id,
							)),
							video_id,
						), 位.KWArgs{
							{Name: "data", Value: 位.NewDictWithTable(map[位.Object]位.Object{
								位.NewStr("additionalfields"):      位.NewStr("language,channel,actors,studio,licenseby,slug,subtitle,teaser,description"),
								位.NewStr("addInteractionOptions"): 位.NewStr("1"),
								位.NewStr("addStatusDetails"):      位.NewStr("1"),
								位.NewStr("addStreamDetails"):      位.NewStr("1"),
								位.NewStr("addCaptions"):           位.NewStr("1"),
								位.NewStr("addScenes"):             位.NewStr("1"),
								位.NewStr("addHotSpots"):           位.NewStr("1"),
								位.NewStr("addBumpers"):            位.NewStr("1"),
								位.NewStr("captionFormat"):         位.NewStr("data"),
							})},
							{Name: "headers", Value: 位.NewDictWithTable(map[位.Object]位.Object{
								位.NewStr("X-Request-CID"):   cid,
								位.NewStr("X-Request-Token"): request_token,
							})},
						})
					}
					general = 位.GetItem(video, 位.NewStr("general"))
					title = 位.GetItem(general, 位.NewStr("title"))
					cdn = 位.GetItem(位.GetItem(video, 位.NewStr("streamdata")), 位.NewStr("cdnType"))
					if 位.IsTrue(位.Eq(cdn, 位.NewStr("azure"))) {
						formats = 位.Cal(位.GetAttr(self, "_extract_azure_formats", nil), video, video_id)
					} else {
						if 位.IsTrue(位.Eq(cdn, 位.NewStr("free"))) {
							formats = 位.Cal(位.GetAttr(self, "_extract_free_formats", nil), video, video_id)
						} else {
							if !位.IsTrue(位.False) {
								panic(位.Raise(位.Cal(位.AssertionErrorType)))
							}
						}
					}
					位.Cal(位.GetAttr(self, "_sort_formats", nil), formats)
					return 位.NewDictWithTable(map[位.Object]位.Object{
						位.NewStr("id"):           video_id,
						位.NewStr("title"):        title,
						位.NewStr("alt_title"):    位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("subtitle")),
						位.NewStr("description"):  位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("description")),
						位.NewStr("release_year"): 位.Cal(int_or_none, 位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("year"))),
						位.NewStr("creator"): func() 位.Object {
							if 位v := 位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("studio")); 位.IsTrue(位v) {
								return 位v
							} else {
								return 位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("studio_adref"))
							}
						}(),
						位.NewStr("thumbnail"): 位.Cal(try_get, video, 位.NewFunction("<lambda>",
							[]位.Param{
								{Name: "x"},
							},
							0, false, false,
							func(位args []位.Object) 位.Object {
								var (
									x = 位args[0]
								)
								return 位.GetItem(位.GetItem(x, 位.NewStr("imagedata")), 位.NewStr("thumb"))
							}), compat_str),
						位.NewStr("duration"):  位.Cal(parse_duration, 位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("runtime"))),
						位.NewStr("timestamp"): 位.Cal(int_or_none, 位.Cal(位.GetAttr(general, "get", nil), 位.NewStr("uploaded"))),
						位.NewStr("episode_number"): 位.Cal(int_or_none, 位.Cal(try_get, video, 位.NewFunction("<lambda>",
							[]位.Param{
								{Name: "x"},
							},
							0, false, false,
							func(位args []位.Object) 位.Object {
								var (
									x = 位args[0]
								)
								return 位.GetItem(位.GetItem(x, 位.NewStr("episodedata")), 位.NewStr("episode"))
							}))),
						位.NewStr("season_number"): 位.Cal(int_or_none, 位.Cal(try_get, video, 位.NewFunction("<lambda>",
							[]位.Param{
								{Name: "x"},
							},
							0, false, false,
							func(位args []位.Object) 位.Object {
								var (
									x = 位args[0]
								)
								return 位.GetItem(位.GetItem(x, 位.NewStr("episodedata")), 位.NewStr("season"))
							}))),
						位.NewStr("formats"): formats,
					})
				})
			return 位.NewDictWithTable(map[位.Object]位.Object{
				位.NewStr("_TESTS"):                 NexxIE__TESTS,
				位.NewStr("_VALID_URL"):             NexxIE__VALID_URL,
				位.NewStr("_extract_azure_formats"): NexxIE__extract_azure_formats,
				位.NewStr("_extract_free_formats"):  NexxIE__extract_free_formats,
				位.NewStr("_real_extract"):          NexxIE__real_extract,
			})
		}())
		NexxEmbedIE = 位.Cal(位.TypeType, 位.NewStr("NexxEmbedIE"), 位.NewTuple(InfoExtractor), func() 位.Dict {
			var (
				NexxEmbedIE__VALID_URL 位.Object
			)
			NexxEmbedIE__VALID_URL = 位.NewStr("https?://embed\\.nexx(?:\\.cloud|cdn\\.com)/\\d+/(?P<id>[^/?#&]+)")
			return 位.NewDictWithTable(map[位.Object]位.Object{
				位.NewStr("_VALID_URL"): NexxEmbedIE__VALID_URL,
			})
		}())
	})
}
